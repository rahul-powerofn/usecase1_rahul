

CREATE DATABASE USECASE4_RAHUL;

CREATE TABLE EMPLOYEE
(ID CHAR(4) NOT NULL PRIMARY KEY,
NAME VARCHAR(10),
DEPARTMENT CHAR(4),
ACTIVE ENUM(‘1’,’0’),
GENDER ENUM(‘M’,’F’),
ROLE_ID CHAR(4)
);
CREATE TABLE DEPARTMENT
(
ID CHAR(4) NOT  NULL PRIMARY KEY,
NAME VARCHAR(10)
);
CREATE TABLE ROLES
(
ID CHAR(4) NOT NULL PRIMARY KEY,
NAME VARCHAR(15)
);

CREATE TABLE REPORTING 
(  ID CHAR(4) NOT NULL PRIMARY KEY,
L2 CHAR(4) DEFAULT NULL,
L1 CHAR(4) DEFAULT NULL);

CREATE TABLE EMP_ACTIVE_DATE
(ID CHAR(4) NOT NULL,
ACTIVE_FROM DATE,
RESIGNED_ON DATE DEFAULT NULL);

INSERT INTO TABLE EMPLOYEE
VALUES (
‘E001’,’RAJKUMAR’,’D001’,’1’,’M’,’ROO1’);





1.SELECT  DEPARTMENT.ID ,DEPARTMENT.NAME ,COUNT(EMPLOYEE.DEPARTMENT) AS STRENGHT FROM DEPARTMENT JOIN EMPLOYEE ON DEPARTMENT.ID=EMPLOYEE.DEPARTMENT GROUP BY EMPLOYEE.DEPARTMENT;









4. SELECT EMPLOYEE.ID,EMPLOYEE.NAME AS EMPLOYEE,EMPLOYEE.DEPARTMENT,DATEDIFF(curdate(),EMP_ACTIVE_DATE.ACTIVE_FROM) as DAYS from EMPLOYEE JOIN EMP_ACTIVE_DATE ON EMPLOYEE.ID=EMP_ACTIVE_DATE.ID WHERE DATEDIFF(curdate(),EMP_ACTIVE_DATE.ACTIVE_FROM)>1500;




2.SELECT EMPLOYEE.ID AS ID,EMPLOYEE.NAME AS EMPLOYEE,L2,L1 FROM EMPLOYEE JOIN (SELECT EMPLOYEE.ID AS ID,IF(L2 IS NULL,'-',(SELECT NAME FROM EMPLOYEE WHERE ID=L2)) AS L2,IF (L1 IS NULL, '-',(SELECT NAME FROM EMPLOYEE WHERE ID=L1)) AS L1 FROM EMPLOYEE JOIN REPORTING ON EMPLOYEE.ID=REPORTING.ID) REP ON EMPLOYEE.ID=REP.ID ORDER BY EMPLOYEE.ID;





5.SELECT DEPARTMENT.NAME AS DEPARTMENT,COUNT(IF(GENDER='F',1,NULL))*100/COUNT(IF(GENDER='F',1,1)) AS PERCENTAGE FROM EMPLOYEE JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT=DEPARTMENT.ID GROUP BY DEPARTMENT;
